const express = require("express");
const router = express.Router();


router.post('/getPassword', async (req, res) => {
    const { username } = req.body;
  
    try {
      // Read the usernames.txt file
      const filePath = path.join(__dirname, 'usernames.txt');
      const data = await fs.readFile(filePath, 'utf8');
      
      // Split the file content into lines
      const lines = data.trim().split('\n');
  
      // Search for the username in the file
      let found = false;
      let password = 'User not found';
      for (const line of lines) {
        const [storedUsername, storedPassword] = line.split(':');
        if (storedUsername === username) {
          found = true;
          password = storedPassword;
          break;
        }
      }
  
      // Render the getPassword view with the retrieved password
      res.render('getPassword', { password });
    } catch (error) {
      console.error('Error retrieving password:', error);
      res.status(500).send('Internal Server Error');
    }
  });

  module.exports = router;